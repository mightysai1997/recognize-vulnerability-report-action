import {Vulnerability} from '../models/vulnerability'
import {VulnerabilitySeverity} from '../models/vulnerability-severity'

const sortOrder = (vulnerability: Vulnerability): number => {
  switch (vulnerability.securityVulnerability.severity) {
    case VulnerabilitySeverity.CRITICAL:
      return 1
    case VulnerabilitySeverity.HIGH:
      return 2
    case VulnerabilitySeverity.MODERATE:
      return 3
    case VulnerabilitySeverity.LOW:
      return 4
  }
}

export const sortVulnerabilities = (
  vulnerabilities: Vulnerability[]
): Vulnerability[] =>
  vulnerabilities.sort((a, b) => sortOrder(a) - sortOrder(b))
